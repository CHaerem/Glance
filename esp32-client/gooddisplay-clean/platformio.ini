[env:esp32s3]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf

monitor_speed = 115200
upload_speed = 460800

board_build.flash_size = 16MB
board_upload.flash_size = 16MB
board_build.partitions = partitions_ota.csv

; Firmware version - set via environment variable or defaults to dev
; CI/CD sets FIRMWARE_VERSION to git SHA
; For local testing, add: -DSKIP_OTA=1 (prevents server firmware from overwriting)
build_flags =
    '-DFIRMWARE_VERSION="${sysenv.FIRMWARE_VERSION}"'
    '-DWIFI_SSID="${sysenv.WIFI_SSID}"'
    '-DWIFI_PASSWORD="${sysenv.WIFI_PASSWORD}"'
    '-DDEVICE_ID="${sysenv.DEVICE_ID}"'

; Native test environment for running unit tests on host machine (Mac/Linux)
; Tests pure logic functions without hardware dependencies
; Run with: pio test -e native
[env:native]
platform = native
build_flags = -std=c11
lib_deps =
test_framework = unity
test_build_src = false
